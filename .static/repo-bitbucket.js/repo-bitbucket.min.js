!function(t,e,i){var a=1,s=!1,n=!1,r={get:function(t){var i=e.location.hash;if(i.length>0){var a=i.match(new RegExp(t+":{([a-zA-Z0-9,-]*)}"));if(a)return a[1].split(",")}return[]},set:function(t,i){var a,s=e.location.hash,n=t+":{"+i.join(",")+"}",r=s.indexOf(t+":{");return 0===i.length?this.remove(t):(a=-1!==r?s.replace(new RegExp("("+t+":{[a-zA-Z0-9,-]*})"),n):s.length>0?s+","+n:n,e.location.hash=a,void 0)},remove:function(t){e.location.hash=e.location.hash.replace(new RegExp("([,]?"+t+":{[a-zA-Z0-9,-]*}[,]?)"),"")}},c={numberRange:/^([0-9]+)-([0-9]+)$/,pageNumber:/-([0-9]+)$/,multilineBegin:/<span class="([\w-_][^"]+)">(?:.[^<]*(?!<\/span>)|)$/gi,multilineEnd:/(<span class="([\w-_][^"]+)">)?(?:.[^<]*)?(<\/span>)/gi};t.fn.vanGogh=function(o){function l(){if(s||n)setTimeout(l,100);else{if(p++,p>=10)return;if(o.source&&!f)return n=!0,t.ajax({url:o.source,crossDomain:!0,dataType:"text",success:function(t){f=t},error:function(t,e){f="ERROR: "+e},complete:function(){n=!1,l()}}),void 0;if(i=i||e.hljs,!i)return s=!0,t.getScript(o.autoload,function(){s=!1,l()}),void 0;g.filter("pre,code").each(function(){function e(e,i,a){var o=s.find(".vg-line");i&&(s.find(".vg-highlight").removeClass("vg-highlight"),r.remove(n),p=[]),e="array"===t.type(e)?e:[e],t.each(e,function(e,i){if(p.indexOf(i)<=-1)if(!isNaN(parseFloat(i,10))&&isFinite(i)&&(i=parseInt(i,10)),"string"===t.type(i)){var a=c.numberRange.exec(i);if(a){for(var r=a[1],l=a[2],h="",e=r;l>=e;e++)h+=",#"+n+"-"+e,p.push(e);o.filter(h.substring(1)).addClass("vg-highlight")}else s.find(".vg-line:contains("+i+")").each(function(){var e=t(this).addClass("vg-highlight");e.html(e.html().replace(i,'<span class="vg-highlight">'+i+"</span>"))}),p.push(i)}else{var u=n+"-"+this,f=o.filter("#"+u);f.length&&(f.addClass("vg-highlight"),p.push(i))}}),!a&&r.set(n,p)}var s=t(this).addClass("vg-container").attr("id",this.id||"vg-"+a++),n=this.id,l=s.find("code"),u=!1,g=!1,p=[];l.length||(l=s,u=!0),o.source&&f&&l.text(f);l.text();i.highlightBlock(l[0],o.tab);var d=l.html().split("\n"),v="",m="";if(u)u&&s.addClass("vg-code");else{var b={},x=0;t.each(d,function(t,e){var i=t+o.firstLine,a=n+"-"+i,s=e;if(o.numbers&&(v+='<a class="vg-number" rel="#'+a+'">'+i+"</a>"),b[x]){var r=c.multilineEnd.exec(e);r&&!r[1]?(s='<span class="'+b[x]+'">'+s,delete b[x],x--):s='<span class="'+b[x]+'">'+s+"</span>"}var l=c.multilineBegin.exec(e);l&&(x++,b[x]=l[1]),m+='<div class="vg-line" id="'+a+'">'+s+"</div>"}),m='<code class="vg-code">'+m+"</code>",o.numbers&&(m='<div class="vg-gutter">'+v+"</div>"+m),s.html(m),l=s.find("code"),s.find(".vg-number").click(function(i){var a=t(this),o=a.attr("rel"),l=s.find(o);if(l.hasClass("vg-highlight"))return l.removeClass("vg-highlight"),p.splice(p.indexOf(a.text()),1),r.set(n,p),g=!1,!1;var h=g;return g=parseInt(c.pageNumber.exec(o)[1],10),i.shiftKey&&g?e(g>h?h+"-"+g:g+"-"+h,!0):e(g,i.ctrlKey?!1:!0),!1});var _=s.find(".vg-gutter"),k=_.outerWidth(),y=0,j=!1;o.animateGutter&&s.scroll(function(){if(this.scrollLeft!==y)if(this.scrollLeft>k){if(this.scrollLeft<y)y=this.scrollLeft,_.hide();else if(this.scrollLeft!==y){if(j)return;var t=this;y=this.scrollLeft,j=setTimeout(function(){j=!1;var e=t.scrollLeft;l.css("marginLeft",k),_.css({"float":"none",position:"absolute",left:e-k}).show().stop().animate({left:e})},500)}}else y=this.scrollLeft,clearTimeout(j),j=!1,_.css({"float":"",position:"",left:""}).show()})}if(l.dblclick(function(){return h(l[0]),!1}),o.maxLines>0){var E=s.find(".vg-line").height(),L=parseInt(l.css("paddingTop")),R=E*(o.maxLines+1)+L;s.css({minHeight:E+L,maxHeight:R})}o.highlight&&e(o.highlight,!0,!0);var w=r.get(n);w.length&&e(w,!1,!0)})}}function h(t){var i=e,a=e.document;if(a.body.createTextRange){var s=a.body.createTextRange();s.moveToElementText(t),s.select()}else if(a.createRange){var n=i.getSelection(),s=a.createRange();s.selectNodeContents(t),n.removeAllRanges(),n.addRange(s)}}var u={language:"auto",firstLine:1,maxLines:0,numbers:!0,highlight:null,animateGutter:!0,autoload:"http://softwaremaniacs.org/media/soft/highlight/highlight.pack.js",tab:"    "};o=t.extend({},u,o);var f,g=this,p=0;return l(),g}}(jQuery,this,"undefined"!=typeof this.hljs?this.hljs:!1),function(t){t.fn.extend({bitbucket:function(e){var i={png:"image",gif:"image",jpg:"image",jpeg:"image",zip:"bin",war:"bin"},a=t.extend({user:"",repository:"",revision:"master"},e),s={},n="",r=[],c="",o=document;s.prepare=function(e){t("body").prepend(t('<style id="bitbucket_style_css">').html(n)),e.attr("class","bitbucket_css")},s.header=function(e){e=e?e:"",t(".bitbucket_css .bitbucket_css_header").html("<span>"+e+"</span>")},s.error=function(e,i){i=i?i:"Error",e=e?e:"Unknown error...",t(".bitbucket_css .bitbucket_css_header").html("<span>Error</span>"),t(".bitbucket_css .bitbucket_css_content").html("<span></span>")};var l=function(e){var i=t(o.createElement("a"));i.attr("href","javascript:"),i.attr("x-path",e),i.attr("x-name",e),i.attr("class","dir"),i.html(e),t("#"+c+" .bitbucket_css_content").append(i),i.click(function(e){var i=t(e.target);u.folder(i.attr("x-path"))})},h=function(e){var a=t(o.createElement("a"));a.attr("href","javascript:"),a.attr("x-path",e.path),a.attr("x-name",e.name),a.attr("class","file"),a.html(e.name),t("#"+c+" .bitbucket_css_content").append(a),a.click(function(e){var a=t(e.target),s=a.attr("x-name").split(".").pop();switch(i[s]){case"image":u.image(a.attr("x-path"));break;case"bin":u.bin(a.attr("x-path"));break;default:u.file(a.attr("x-path"))}})},u={};return u.folder=function(e){e?r.push(e):r=[];var i="https://api.bitbucket.org/1.0/repositories/"+a.user+"/"+a.repository+"/src/"+a.revision+"/"+r.join("/");t.ajax({url:i,type:"GET",data:{},cache:!1,dataType:"jsonp",objId:c,success:function(e){t("#"+c+" .bitbucket_css_content").empty();var i=t(o.createElement("a"));i.attr("href","javascript:"),i.html(a.repository+" / "+r.join(" / ")),i.click(function(){u.folder()}),t(".bitbucket_css .bitbucket_css_header span").empty(),t(".bitbucket_css .bitbucket_css_header span").append(i);for(var s=0;s<e.directories.length;s++){var n=e.directories[s];l(n)}for(var s=0;s<e.files.length;s++){var f=e.files[s];f.name=f.path.replace(e.path,""),h(f)}},error:function(){s.error("No repository found...")}})},u.image=function(e){var i="https://api.bitbucket.org/1.0/repositories/"+a.user+"/"+a.repository+"/raw/"+a.revision+"/";t("#"+c+" .bitbucket_css_content").html('<img src="'+i+e+'">')},u.bin=function(){},u.file=function(e){var i="https://api.bitbucket.org/1.0/repositories/"+a.user+"/"+a.repository+"/src/"+a.revision+"/";t.ajax({url:i+e,type:"GET",data:{},cache:!1,dataType:"jsonp",success:function(e){var i=t(o.createElement("pre")),a=t(o.createElement("code"));a.text(e.data).html(),i.html(a),t("#"+c+" .bitbucket_css_content").html(i),i.vanGogh()},error:function(){t("#"+c+" .bitbucket_css_content").html("Cannot show file from repository...")}})},this.each(function(){var e=t(this);c=e.attr("id"),e.html('<div class="bitbucket_css_header"></div><div class="bitbucket_css_content"></div>'),s.prepare(e),s.header("Loading repository..."),u.folder()})}})}(jQuery);